# 磁性设置

当体系具有磁性时，需要在`&DFT`模块中进行`UKS`和`MULTIP`的设置，同时在`&KIND`模块中进行`&BS`模块的设置。下面以`MnO2`为例进行详细说明。

查阅元素周期表可知，Mn原子的价电子为`3d5 4s2`，O原子的价电子为`2s2 2p4`。二者结合形成化合物后，相应元素的电子组态分别变为：Mn4+：`3d3`；O2-：`2s2 2p6`。其中Mn4+中的3个d电子平行排列。

首先，我们进行`&DFT`模块的设置。假设所建立的超胞模型含有`48`个原子（16个Mn，32个O），则`&DFT`模块应设置如下：通过设置`UKS T`进行自旋极化计算；`MULTIP`为体系总的多重度：`2*S+1`，其中`S`为体系的总自旋，与体系的磁结构有关。若体系为铁磁性，即Mn的磁矩均平行排列，则根据上一段的分析，`S=16*3*1/2`，因而多重度`MULTIP=49`。

```cp2k
&DFT
 UKS T
 MULTIP 49
&END DFT
```

**需注意，若体系为反铁磁性，则S=0，那么MULTIP应设置为1。**

接下来，我们进行`&BS`模块的设置，此处依然考虑铁磁性的情况。`BS`的设置较为复杂，规则如下：

根据前述，在形成化合物时，Mn从原子态变为Mn4+态，相应的电子组态从`3d5 4s2`变为了`3d3`。由于我们考虑的体系为铁磁性，因而Mn4+的所有单电子（3个d电子）应自旋平行，即应该都为ALPHA电子（或都为BETA电子，此处仅考虑都为ALPHA电子的情况）。也就是说，形成化合物时，Mn的电子组态发生的变化为：在5个3d电子的基础上形成了3个ALPHA电子，并且失去2个4s电子。这个过程涉及3d电子和4s电子，则在`N`处应填入`3 4`（上述过程涉及电子的`主量子数`，此处为3d和4s电子，因而填入`3`和`4`）；在`L`处，在`3`的下方应填入`2`，在`4`的下方应填入`0`（上述过程涉及电子的`角量子数`，此处为3d和4s电子，由于d电子的`L=2`，s电子的`L=0`，因而填入`2`和`0`）；对应的，在`NEL`处，上述过程从5个d电子变为了3个ALPHA电子，则按照`CP2K`的设置，应有`（5+NEL）/2=3`，即`NEL=1`；并且上述过程失去了2个4s电子，对ALPHA电子没有贡献，则应有`（2+NEL）/2=0`，即`NEL=-2`。类似的，对于`&BETA`模块，由于体系没有BETA电子，则在`NEL`处应分别填入`-5`和`-2`，从而分别满足`（5+NEL）/2=0`和`（2+NEL）/2=0`。

```cp2k
&KIND Mn
 &BS T
  &ALPHA
   N 3 4
   L 2 0
   NEL +1 -2
  &END ALPHA
  &BETA
   N 3 4
   L 2 0
   NEL -5 -2
  &END BETA
 &END BS
&END KIND
```